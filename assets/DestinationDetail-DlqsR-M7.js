import{r as n,j as e}from"./vendor-ui-QgVN0H1W.js";import{L as w,b as F}from"./vendor-react-GoYkDhlm.js";import{c as H,h as B,u as T,s as c,B as m,L as C,C as U,M as Y}from"./index-z_EbRe_p.js";import{g as $,M as z,C as W,F as O}from"./destinations-Di3xjZ-g.js";import{N as V,B as G}from"./Navbar-CS4KFtzu.js";import{F as J}from"./Footer-BVpW2v9u.js";import{T as K}from"./textarea-C3TDWHj2.js";import{S}from"./star-15eeobaE.js";import{S as Q}from"./send-BEMNvcIY.js";import{A as X,m as Z}from"./vendor-motion-7Gg7V_LS.js";import{U as ee}from"./gonepallogo-Cu4Fv82l.js";import se from"./AIChatbot-6a8KQ8GL.js";import{A as q}from"./arrow-left-DcmaaTR1.js";import{B as te}from"./markdownParser-CvRXSPA6.js";import{C as ae}from"./calendar-0ym-T44f.js";import"./vendor-charts-K-ahvkCb.js";import"./newspaper-Bh7e0O0f.js";import"./mail-DMF2ambA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=H("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),re=({placeId:g})=>{const{user:i}=B(),{toast:l}=T(),[t,x]=n.useState([]),[j,b]=n.useState(!0),[N,u]=n.useState(!1),[f,v]=n.useState(5),[_,a]=n.useState(0),[r,h]=n.useState(""),[o,D]=n.useState(null);n.useEffect(()=>{k()},[g]);const k=async()=>{try{const{data:s,error:p}=await c.from("reviews").select(`
          id,
          rating,
          comment,
          created_at,
          user_id
        `).eq("place_id",g).order("created_at",{ascending:!1});if(p)throw p;const y=[...new Set(s?.map(d=>d.user_id)||[])],{data:M}=await c.from("profiles").select("id, full_name, avatar_url").in("id",y),P=(s||[]).map(d=>({...d,profile:M?.find(R=>R.id===d.user_id)||null}));if(x(P),i){const d=P.find(R=>R.user_id===i.id);d&&(D(d),v(d.rating),h(d.comment||""))}}catch(s){console.error("Error fetching reviews:",s)}finally{b(!1)}},L=async()=>{if(i){if(!r.trim()){l({variant:"destructive",title:"Please write a comment"});return}u(!0);try{if(o){const{error:s}=await c.from("reviews").update({rating:f,comment:r.trim()}).eq("id",o.id);if(s)throw s;l({title:"Review updated!"})}else{const{error:s}=await c.from("reviews").insert({place_id:g,user_id:i.id,rating:f,comment:r.trim()});if(s)throw s;l({title:"Review submitted!"})}k()}catch(s){l({variant:"destructive",title:"Error",description:s.message})}finally{u(!1)}}},I=async()=>{if(o)try{const{error:s}=await c.from("reviews").delete().eq("id",o.id);if(s)throw s;D(null),v(5),h(""),k(),l({title:"Review deleted"})}catch(s){l({variant:"destructive",title:"Error",description:s.message})}},E=t.length>0?(t.reduce((s,p)=>s+p.rating,0)/t.length).toFixed(1):"0";return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"heading-section text-foreground mb-2",children:"Reviews"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(s=>e.jsx(S,{className:`w-5 h-5 ${s<=Number(E)?"fill-nepal-gold text-nepal-gold":"text-muted-foreground"}`},s))}),e.jsx("span",{className:"font-semibold text-foreground",children:E}),e.jsxs("span",{className:"text-muted-foreground",children:["(",t.length," reviews)"]})]})]})}),e.jsx("div",{className:"bg-card rounded-xl p-6 border border-border",children:i?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:o?"Update Your Review":"Write a Review"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Your rating:"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onMouseEnter:()=>a(s),onMouseLeave:()=>a(0),onClick:()=>v(s),className:"focus:outline-none",children:e.jsx(S,{className:`w-6 h-6 transition-colors ${s<=(_||f)?"fill-nepal-gold text-nepal-gold":"text-muted-foreground hover:text-nepal-gold/50"}`})},s))})]}),e.jsx(K,{value:r,onChange:s=>h(s.target.value),placeholder:"Share your experience...",rows:3,maxLength:500,className:"resize-none"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{onClick:L,disabled:N,className:"btn-primary gap-2",children:[N?e.jsx(C,{className:"w-4 h-4 animate-spin"}):e.jsx(Q,{className:"w-4 h-4"}),o?"Update Review":"Submit Review"]}),o&&e.jsx(m,{variant:"outline",onClick:I,className:"text-destructive hover:text-destructive",children:"Delete Review"})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(A,{className:"w-10 h-10 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Sign in to write a review"}),e.jsx(w,{to:"/auth",children:e.jsx(m,{className:"btn-primary",children:"Sign In"})})]})}),e.jsx("div",{className:"space-y-4",children:j?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(C,{className:"w-6 h-6 animate-spin text-primary"})}):t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No reviews yet. Be the first to review!"})]}):e.jsx(X,{children:t.map((s,p)=>e.jsx(Z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:p*.05},className:"bg-card rounded-xl p-5 border border-border",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:s.profile?.avatar_url?e.jsx("img",{src:s.profile.avatar_url,alt:"",className:"w-full h-full rounded-full object-cover"}):e.jsx(ee,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground",children:[s.profile?.full_name||"Anonymous",s.user_id===i?.id&&e.jsx("span",{className:"ml-2 text-xs text-accent",children:"(You)"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(y=>e.jsx(S,{className:`w-4 h-4 ${y<=s.rating?"fill-nepal-gold text-nepal-gold":"text-muted-foreground"}`},y))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]})}),s.comment&&e.jsx("p",{className:"text-muted-foreground text-sm",children:s.comment})]})]})},s.id))})})]})},we=()=>{const{id:g}=F(),{user:i}=B(),{toast:l}=T(),t=$(g||""),[x,j]=n.useState(!1),[b,N]=n.useState(!1),[u,f]=n.useState(null);n.useEffect(()=>{t&&i&&v()},[t,i]);const v=async()=>{if(!(!i||!t))try{const{data:a}=await c.from("places").select("id").eq("name",t.name).maybeSingle();if(a){f(a.id);const{data:r}=await c.from("saved_places").select("id").eq("user_id",i.id).eq("place_id",a.id).maybeSingle();j(!!r)}}catch(a){console.error("Error checking saved status:",a)}},_=async()=>{if(!i){l({title:"Please sign in to save places"});return}if(t){N(!0);try{let a=u;if(!a){const{data:r,error:h}=await c.from("places").insert({name:t.name,description:t.description,category:t.category,image_url:t.image}).select("id").single();if(h)throw h;a=r.id,f(a)}if(x){const{error:r}=await c.from("saved_places").delete().eq("user_id",i.id).eq("place_id",a);if(r)throw r;j(!1),l({title:"Removed from saved places"})}else{const{error:r}=await c.from("saved_places").insert({user_id:i.id,place_id:a});if(r)throw r;j(!0),l({title:"Added to saved places!"})}}catch(a){l({variant:"destructive",title:"Error",description:a.message})}finally{N(!1)}}};return t?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{}),e.jsxs("section",{className:"relative h-[60vh] min-h-[400px]",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/90 via-primary/50 to-transparent"})]}),e.jsx("div",{className:"absolute inset-0 flex items-end",children:e.jsxs("div",{className:"container-wide pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(w,{to:"/",children:e.jsxs(m,{variant:"outline",className:"border-primary-foreground/50 text-primary-foreground bg-transparent hover:bg-primary-foreground/10",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Back to Home"]})}),e.jsxs(m,{variant:"outline",onClick:_,disabled:b,className:`border-primary-foreground/50 bg-transparent hover:bg-primary-foreground/10 ${x?"text-nepal-gold border-nepal-gold":"text-primary-foreground"}`,children:[b?e.jsx(C,{className:"w-4 h-4 animate-spin mr-2"}):x?e.jsx(te,{className:"w-4 h-4 mr-2"}):e.jsx(G,{className:"w-4 h-4 mr-2"}),x?"Saved":"Save"]})]}),e.jsx("span",{className:"inline-block bg-accent text-accent-foreground px-4 py-1.5 rounded-full text-sm font-medium mb-4",children:t.category}),e.jsx("h1",{className:"heading-display text-primary-foreground mb-2",children:t.name}),e.jsx("p",{className:"text-2xl text-primary-foreground/80 font-display italic",children:t.tagline})]})})]}),e.jsx("section",{className:"bg-card border-b border-border",children:e.jsx("div",{className:"container-wide py-6",children:e.jsxs("div",{className:"flex flex-wrap gap-6 md:gap-12",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"font-medium text-foreground",children:t.duration})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Best Time"}),e.jsx("p",{className:"font-medium text-foreground",children:t.bestTime})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Altitude"}),e.jsx("p",{className:"font-medium text-foreground",children:t.altitude})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Difficulty"}),e.jsx("p",{className:"font-medium text-foreground",children:t.difficulty})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 fill-nepal-gold text-nepal-gold"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rating"}),e.jsxs("p",{className:"font-medium text-foreground",children:[t.rating," / 5"]})]})]})]})})}),e.jsx("section",{className:"section-padding",children:e.jsx("div",{className:"container-wide",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-12",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"heading-section text-foreground mb-6",children:"Overview"}),e.jsx("p",{className:"text-body-large text-muted-foreground leading-relaxed",children:t.fullDescription})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"heading-section text-foreground mb-6",children:"Top Attractions"}),e.jsx("div",{className:"space-y-6",children:t.attractions.map((a,r)=>e.jsx("div",{className:"bg-card rounded-xl p-6 border border-border",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent/10 flex items-center justify-center flex-shrink-0",children:e.jsx(Y,{className:"h-5 w-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-foreground mb-2",children:a.name}),e.jsx("p",{className:"text-muted-foreground",children:a.description})]})]})},r))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"heading-section text-foreground mb-6",children:"Suggested Itinerary"}),e.jsx("div",{className:"space-y-4",children:t.itinerary.map((a,r)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-accent text-accent-foreground flex items-center justify-center font-bold text-sm",children:(a.day.split(" ")[0]==="Days",a.day.split(" ")[1])}),r<t.itinerary.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-border mt-2"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("p",{className:"text-sm text-accent font-medium",children:a.day}),e.jsx("h3",{className:"font-display text-lg font-semibold text-foreground mb-2",children:a.title}),e.jsx("p",{className:"text-muted-foreground",children:a.description})]})]},r))})]}),u&&e.jsx(re,{placeId:u})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-foreground mb-4",children:"Highlights"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.highlights.map(a=>e.jsx("span",{className:"bg-accent/10 text-accent px-3 py-1.5 rounded-full text-sm font-medium",children:a},a))})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 border border-border",children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-foreground mb-4",children:"Travel Tips"}),e.jsx("ul",{className:"space-y-3",children:t.tips.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-3 text-muted-foreground",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:a})]},r))})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(O,{className:"h-5 w-5 text-accent"}),e.jsx("h3",{className:"font-display text-xl font-semibold text-foreground",children:"Permits Required"})]}),e.jsx("ul",{className:"space-y-3",children:t.permits.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-3 text-muted-foreground",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:a})]},r))})]}),e.jsxs("div",{className:"bg-primary rounded-xl p-6",children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-primary-foreground mb-2",children:"Ready to Explore?"}),e.jsxs("p",{className:"text-primary-foreground/80 text-sm mb-4",children:["Start planning your ",t.name," adventure today."]}),e.jsx(w,{to:"/#plan",children:e.jsx(m,{className:"w-full bg-accent text-accent-foreground hover:bg-accent/90",children:"Plan Your Trip"})})]})]})]})})}),e.jsx(J,{}),e.jsx(se,{})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-foreground mb-4",children:"Destination Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Sorry, we couldn't find the destination you're looking for."}),e.jsx(w,{to:"/",children:e.jsxs(m,{className:"btn-accent",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Back to Home"]})})]})})};export{we as default};
