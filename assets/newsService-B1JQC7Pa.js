const l="https://images.unsplash.com/photo-1544735716-392fe2489ffa?q=80&w=1000&auto=format&fit=crop",h=(t,n)=>{const r=["flood","landslide","earthquake","avalanche","emergency","disaster","alert","strike","bandh","protest","demonstration","blockade","holi","dashain","tihar","festival","parade"],o=["irrelevant","spam","ads"];return t.filter(e=>{const c=e.title.toLowerCase();return!o.some(i=>c.includes(i))}).slice(0,10).map(e=>{const c=e.title.toLowerCase(),i=r.some(s=>c.includes(s));let a=e.thumbnail||e.enclosure?.link;if(!a&&e.description){const s=e.description.match(/<img[^>]+src="([^">]+)"/);s&&(a=s[1])}if(!a&&e.content){const s=e.content.match(/<img[^>]+src="([^">]+)"/);s&&(a=s[1])}return{title:e.title,link:e.link,pubDate:e.pubDate||new Date().toISOString(),thumbnail:a||l,source:`Verified Source: ${n}`,isEmergency:i,lastUpdated:new Date().toLocaleTimeString()}})},m=async()=>(await f()).filter(n=>n.isEmergency),d=[{name:"OnlineKhabar English",rss:"https://english.onlinekhabar.com/feed"},{name:"OnlineKhabar",rss:"https://www.onlinekhabar.com/feed"}],f=async()=>{for(const t of d)try{const n=`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(t.rss)}&count=10`,r=await fetch(n);if(!r.ok)continue;const o=await r.json();if(o.status!=="ok"||!o.items?.length)continue;return console.info(`[News] Loaded from: ${t.name}`),h(o.items,t.name)}catch(n){console.warn(`[News] Failed source ${t.name}:`,n)}return console.error("[News] All sources failed."),[]};export{m as a,f};
