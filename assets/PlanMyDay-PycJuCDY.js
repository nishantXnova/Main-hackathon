import{r as n,j as e}from"./vendor-ui-QgVN0H1W.js";import{c as ee,S as _,X as W,T as te,M as B,a as D,o as p,B as z,p as ae,D as se,C as re,s as O,b as ie,q as ne}from"./index-z_EbRe_p.js";import{a as le}from"./newsService-B1JQC7Pa.js";import{A as oe,m as i}from"./vendor-motion-7Gg7V_LS.js";import{R as F,E as ce}from"./badge-CkKTG4N3.js";import{M as de}from"./destinations-Di3xjZ-g.js";import{N as me}from"./Index-C-9-aJIV.js";import"./vendor-charts-K-ahvkCb.js";import"./vendor-react-GoYkDhlm.js";import"./Navbar-CS4KFtzu.js";import"./gonepallogo-Cu4Fv82l.js";import"./newspaper-Bh7e0O0f.js";import"./BookmarkButton-MlHUsGja.js";import"./markdownParser-CvRXSPA6.js";import"./star-15eeobaE.js";import"./calendar-0ym-T44f.js";import"./label-DgzTOcMm.js";import"./select-XZ5OCu-Y.js";import"./textarea-C3TDWHj2.js";import"./copy-BXeSnj4k.js";import"./Footer-BVpW2v9u.js";import"./mail-DMF2ambA.js";import"./vendor-maps-DrZH_TAG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=ee("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);function G(u){const g=[],a=u.split(/(?=\d+\.\s)/);for(const l of a){const s=l.trim();if(!s||!/^\d+\./.test(s))continue;const y=s.split(`
`).map(r=>r.trim()).filter(Boolean),m=y[0]?.replace(/^\d+\.\s*/,"")||"",f=m.match(/\(([^)]+)\)/),j=m.replace(/\([^)]+\)/g,"").replace(/\*\*/g,"").trim(),b=f?.[1]||"",N=y.slice(1).find(r=>!r.toLowerCase().startsWith("tip")&&!r.toLowerCase().startsWith("pro tip")&&!r.startsWith("•")&&!r.startsWith("-"))?.replace(/\*\*/g,"")||"",v=y.find(r=>r.toLowerCase().includes("tip:")),P=v?v.replace(/.*tip[:\s]*/i,"").replace(/\*\*/g,"").trim():"";j&&g.push({time:b,name:j,description:N,tip:P,type:"culture"})}return g.slice(0,4)}const We=({isOpen:u,onClose:g})=>{const[a,l]=n.useState("locating"),[s,y]=n.useState(null),[m,f]=n.useState([]),[j,b]=n.useState(""),[N,v]=n.useState(""),[P,r]=n.useState(null),[d,H]=n.useState([]),[U,M]=n.useState(""),K=t=>t===0?"Clear Skies":t<3?"Partly Cloudy":t<50?"Overcast":t<70?"Rainy":"Stormy",X=t=>t===0?e.jsx(D,{className:"w-8 h-8 text-yellow-500"}):t<3?e.jsx(ie,{className:"w-8 h-8 text-gray-400"}):e.jsx(ne,{className:"w-8 h-8 text-blue-500"}),S=async()=>{l("locating"),f([]),b(""),M(""),navigator.geolocation.getCurrentPosition(async t=>{const{latitude:o,longitude:k}=t.coords;r({lat:o,lng:k}),l("weather");try{const x=(await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${o}&longitude=${k}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m`)).json()).current;let C="Kathmandu";try{const h=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${o}&lon=${k}`)).json();C=h.address?.city||h.address?.town||h.address?.village||"Kathmandu"}catch{}const w={temperature:Math.round(x.temperature_2m),condition:K(x.weather_code),conditionCode:x.weather_code,locationName:C,windSpeed:Math.round(x.wind_speed_10m),humidity:x.relative_humidity_2m};y(w),l("generating");const q=x.weather_code>=50,R=`I am currently in ${C}, Nepal. The weather right now is: ${w.condition}, ${w.temperature}°C, humidity ${w.humidity}%, wind ${w.windSpeed} km/h.

Generate a personalized 4-stop day itinerary for a tourist here. ${q?"Since it is rainy, prioritize indoor attractions like museums, temples, and cafés.":"The weather is nice, so include a mix of outdoor and cultural spots."}

Format your response EXACTLY like this, with 4 numbered entries:
1. [Place Name] ([Time e.g. 9:00 AM - 10:30 AM])
[One sentence description]
Pro Tip: [One practical tip]

2. ...and so on.

Only output the 4 numbered stops, nothing else. Keep tips short and practical.`,{data:Y,error:T}=await O.functions.invoke("ai-chatbot",{body:{message:R,history:[]}});if(T)throw T;const $=Y.reply||"";b($);try{const c=await le();H(c)}catch(c){console.warn("Failed to fetch alerts:",c)}let L=R;if(d.length>0){const c=d.map(I=>`- ${I.title}`).join(`
`);L+=`

CRITICAL: There are active alerts/festivals in the region:
${c}
IMPORTANT: Adjust the itinerary to accommodate these events (maximize safety or cultural experience). Mention the alerts in the tips.`;const{data:h,error:Q}=await O.functions.invoke("ai-chatbot",{body:{message:L,history:[]}});if(!Q){b(h.reply||"");const I=G(h.reply||"");f(I)}}const A=G($);d.length===0&&f(A);const V=encodeURIComponent(A[A.length-1]?.name||C+", Nepal"),Z=A.slice(0,-1).map(c=>encodeURIComponent(c.name+", Nepal")).join("|"),J=`https://www.google.com/maps/dir/?api=1&origin=${o},${k}&destination=${V}&waypoints=${Z}&travelmode=walking`;v(J),l("done")}catch(E){console.error("PlanMyDay error:",E),M("Could not generate your itinerary. Please check your connection and try again."),l("error")}},()=>{M("Location access denied. Please enable location and try again."),l("error")})};return n.useEffect(()=>{u&&S()},[u]),e.jsx(oe,{children:u&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[70] flex items-end sm:items-center justify-center p-0 sm:p-4 bg-black/40 backdrop-blur-md",onClick:g,children:e.jsxs(i.div,{initial:{opacity:0,y:100,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:100,scale:.95},transition:{type:"spring",damping:28,stiffness:300},onClick:t=>t.stopPropagation(),className:"relative w-full sm:max-w-xl bg-white/90 backdrop-blur-xl rounded-t-[2.5rem] sm:rounded-[2.5rem] shadow-2xl overflow-hidden max-h-[92vh] flex flex-col border border-white/20",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-[#E41B17] via-[#c0151a] to-[#8b0000] text-white p-6 pb-10 flex-shrink-0 overflow-hidden",children:[e.jsx(i.div,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-yellow-400/10 rounded-full translate-y-1/2 -translate-x-1/2 blur-2xl"}),e.jsxs("div",{className:"relative flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs("div",{className:"p-1 px-2 rounded-full bg-white/20 backdrop-blur-md border border-white/30 flex items-center gap-1.5",children:[e.jsx(_,{className:"w-3 h-3 text-yellow-300"}),e.jsx("span",{className:"text-white text-[10px] font-bold uppercase tracking-[0.2em]",children:"AI Concierge"})]})}),e.jsx("h2",{className:"text-3xl font-extrabold tracking-tight",children:"Plan My Day"}),e.jsx("p",{className:"text-white/80 text-sm mt-1 max-w-[260px]",children:"AI-generated itinerary based on your live weather & location."})]}),e.jsx("button",{onClick:g,className:"p-2.5 rounded-2xl bg-white/10 hover:bg-white/20 transition-all border border-white/10 group",children:e.jsx(W,{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-300"})})]})]}),e.jsxs("div",{className:"relative -mt-6 bg-white rounded-t-[2.5rem] flex-1 flex flex-col min-h-0 z-10",children:[e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 w-12 h-1.5 bg-gray-200 rounded-full sm:hidden"}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-hide",children:[a==="done"&&d.length>0&&e.jsx(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mb-6 overflow-hidden",children:e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-3xl p-4 flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-2xl flex-shrink-0",children:d[0].title.toLowerCase().includes("fest")||d[0].title.toLowerCase().includes("holi")?e.jsx(xe,{className:"w-5 h-5 text-amber-600"}):e.jsx(te,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-amber-600 uppercase tracking-widest mb-1",children:"Cultural Alert / Advisory"}),e.jsx("h4",{className:"text-sm font-bold text-amber-900 leading-tight mb-1",children:d[0].title}),e.jsx("p",{className:"text-xs text-amber-700 leading-relaxed",children:"AI has adjusted your itinerary to prioritize safety and cultural relevance based on this live update."})]})]})}),(a==="locating"||a==="weather"||a==="generating")&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(i.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-20 h-20 rounded-full border-4 border-dashed border-[#E41B17]/20"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(i.div,{animate:{scale:[1,1.2,1]},transition:{duration:1,repeat:1/0},children:a==="locating"?e.jsx(B,{className:"w-8 h-8 text-[#E41B17]"}):a==="weather"?e.jsx(D,{className:"w-8 h-8 text-yellow-500"}):e.jsx(_,{className:"w-8 h-8 text-purple-500"})})})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"text-gray-900 font-bold text-lg",children:a==="locating"?"Finding your location…":a==="weather"?"Checking the weather…":"AI is crafting your itinerary…"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Powered by AI ✨"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{className:"h-32",variant:"card"}),e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx(p,{className:"h-6 w-32",variant:"text"}),e.jsx(p,{className:"h-6 w-16",variant:"text"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{className:"h-24",variant:"card"}),e.jsx(p,{className:"h-24",variant:"card"}),e.jsx(p,{className:"h-24",variant:"card"})]})]})]}),a==="error"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center",children:e.jsx(W,{className:"w-8 h-8 text-red-400"})}),e.jsx("p",{className:"font-bold text-gray-800",children:U}),e.jsxs(z,{onClick:S,className:"bg-[#E41B17] hover:bg-[#c0151a] text-white rounded-2xl",children:[e.jsx(F,{className:"w-4 h-4 mr-2"})," Try Again"]})]}),a==="done"&&s&&e.jsxs("div",{className:"space-y-6 pb-10",children:[e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative bg-gradient-to-br from-indigo-50/50 via-white to-blue-50/30 rounded-3xl p-5 border border-gray-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(de,{className:"w-24 h-24"})}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white rounded-2xl shadow-sm",children:X(s.conditionCode)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-[10px] font-bold uppercase tracking-widest mb-0.5",children:"Current Skies"}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[s.locationName,e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500 inline-block"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:s.condition})]})]}),e.jsxs("span",{className:"text-4xl font-black text-gray-900",children:[s.temperature,"°"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white/70 rounded-xl border border-gray-50",children:[e.jsx(ae,{className:"w-3.5 h-3.5 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase",children:"Wind"}),e.jsxs("p",{className:"text-xs font-bold text-gray-700",children:[s.windSpeed," km/h"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white/70 rounded-xl border border-gray-50",children:[e.jsx(se,{className:"w-3.5 h-3.5 text-indigo-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase",children:"Humidity"}),e.jsxs("p",{className:"text-xs font-bold text-gray-700",children:[s.humidity,"%"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("h4",{className:"font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-[#E41B17]"}),"Your AI-Crafted Day"]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest bg-gray-100 px-3 py-1 rounded-full",children:[m.length," stops"]})]}),m.length>0?e.jsx("div",{className:"space-y-3",children:m.map((t,o)=>e.jsx(i.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+o*.08},whileHover:{x:4},className:"group bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden",children:e.jsxs("div",{className:"flex items-stretch",children:[e.jsx("div",{className:"w-14 flex flex-col items-center justify-start py-4 border-r border-gray-50 flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 group-hover:bg-[#E41B17] group-hover:text-white transition-colors flex items-center justify-center font-bold text-gray-400 text-sm",children:o+1})}),e.jsxs("div",{className:"flex-1 p-4 pl-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h5",{className:"font-bold text-gray-900 group-hover:text-[#E41B17] transition-colors leading-tight",children:t.name}),t.time&&e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold shrink-0 flex items-center gap-1",children:[e.jsx(re,{className:"w-3 h-3"}),t.time]})]}),t.description&&e.jsx("p",{className:"text-gray-500 text-xs leading-relaxed mb-2",children:t.description}),t.tip&&e.jsx("div",{className:"bg-amber-50/60 rounded-xl p-2.5 border border-amber-100/50",children:e.jsxs("p",{className:"text-[11px] text-amber-900 leading-tight",children:[e.jsx("span",{className:"font-black uppercase text-[9px] mr-1",children:"Pro Tip:"}),t.tip]})})]})]})},o))}):e.jsx("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100",children:e.jsx("p",{className:"text-xs text-gray-600 whitespace-pre-wrap leading-relaxed",children:j})}),N&&e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:e.jsx("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:e.jsxs(z,{className:"w-full h-14 bg-gradient-to-r from-[#E41B17] to-[#8b0000] hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg rounded-2xl relative overflow-hidden group",children:[e.jsx(i.div,{className:"absolute inset-0 bg-white/10",animate:{translateX:["100%","-100%"]},transition:{duration:2.5,repeat:1/0,ease:"linear"}}),e.jsxs("div",{className:"relative flex items-center justify-center gap-2 font-bold text-white text-base",children:[e.jsx(B,{className:"w-5 h-5"}),"Open Route in Google Maps",e.jsx(ce,{className:"w-3.5 h-3.5 opacity-60"})]})]})})}),e.jsxs("button",{onClick:S,className:"w-full flex items-center justify-center gap-2 py-3 text-xs font-bold text-gray-400 hover:text-[#E41B17] transition-colors border-t border-gray-100 mt-2",children:[e.jsx(F,{className:"w-3.5 h-3.5"}),"REGENERATE WITH AI"]})]})]})]})]})})})};export{We as default};
