import{A as O,D as q,r as n,j as e,E as H,F as D,G as B,H as k,O as C,I as S}from"./vendor-ui-QgVN0H1W.js";import{c as P,X as U,e as d,h as V,u as W,s as g,B as c,I as p,L as v,M as j}from"./index-z_EbRe_p.js";import{T as G}from"./textarea-C3TDWHj2.js";import{N as X}from"./Navbar-CS4KFtzu.js";import{F as Y}from"./Footer-BVpW2v9u.js";import{S as J,a as K,b as Q,c as Z,d as $}from"./select-XZ5OCu-Y.js";import{m as ee}from"./vendor-motion-7Gg7V_LS.js";import{P as te}from"./plus-Bs5xrO4y.js";import{S as se}from"./save-Bz55BveC.js";import{S as w}from"./star-15eeobaE.js";import{T as ae}from"./trash-2-BoGUkMaS.js";import"./vendor-charts-K-ahvkCb.js";import"./vendor-react-GoYkDhlm.js";import"./gonepallogo-Cu4Fv82l.js";import"./newspaper-Bh7e0O0f.js";import"./mail-DMF2ambA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=P("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=P("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),ie=O,ne=q,oe=H,_=n.forwardRef(({className:i,...a},l)=>e.jsx(C,{ref:l,className:d("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",i),...a}));_.displayName=C.displayName;const A=n.forwardRef(({className:i,children:a,...l},h)=>e.jsxs(oe,{children:[e.jsx(_,{}),e.jsxs(D,{ref:h,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",i),...l,children:[a,e.jsxs(B,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));A.displayName=D.displayName;const L=({className:i,...a})=>e.jsx("div",{className:d("flex flex-col space-y-1.5 text-center sm:text-left",i),...a});L.displayName="DialogHeader";const T=n.forwardRef(({className:i,...a},l)=>e.jsx(k,{ref:l,className:d("text-lg font-semibold leading-none tracking-tight",i),...a}));T.displayName=k.displayName;const ce=n.forwardRef(({className:i,...a},l)=>e.jsx(S,{ref:l,className:d("text-sm text-muted-foreground",i),...a}));ce.displayName=S.displayName;const de=["Trekking","Heritage","Wildlife","Pilgrimage","Adventure","Nature"],Se=()=>{const{isAdmin:i}=V(),{toast:a}=W(),[l,h]=n.useState([]),[E,I]=n.useState(!0),[N,y]=n.useState(!1),[R,m]=n.useState(!1),[x,b]=n.useState(null),[r,o]=n.useState({name:"",description:"",location:"",category:"",image_url:""});n.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:t,error:s}=await g.from("places").select("*").order("created_at",{ascending:!1});if(s)throw s;h(t||[])}catch(t){console.error("Error fetching places:",t)}finally{I(!1)}},f=()=>{o({name:"",description:"",location:"",category:"",image_url:""}),b(null)},z=t=>{b(t),o({name:t.name,description:t.description||"",location:t.location||"",category:t.category||"",image_url:t.image_url||""}),m(!0)},F=async()=>{if(!r.name.trim()){a({variant:"destructive",title:"Name is required"});return}y(!0);try{if(x){const{error:t}=await g.from("places").update({name:r.name.trim(),description:r.description.trim()||null,location:r.location.trim()||null,category:r.category||null,image_url:r.image_url.trim()||null}).eq("id",x.id);if(t)throw t;a({title:"Place updated successfully"})}else{const t={name:r.name.trim(),description:r.description.trim()||null,location:r.location.trim()||null,category:r.category||null,image_url:r.image_url.trim()||null},{error:s}=await g.from("places").insert(t);if(s)throw s;a({title:"Place created successfully"})}m(!1),f(),u()}catch(t){a({variant:"destructive",title:"Error",description:t.message})}finally{y(!1)}},M=async t=>{if(confirm("Are you sure you want to delete this place?"))try{const{error:s}=await g.from("places").delete().eq("id",t);if(s)throw s;a({title:"Place deleted successfully"}),u()}catch(s){a({variant:"destructive",title:"Error",description:s.message})}};return i?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(X,{}),e.jsx("main",{className:"container-wide pt-24 pb-16",children:e.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"heading-section text-3xl",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage destinations and content"})]}),e.jsxs(ie,{open:R,onOpenChange:t=>{m(t),t||f()},children:[e.jsx(ne,{asChild:!0,children:e.jsxs(c,{className:"btn-primary gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Add Place"]})}),e.jsxs(A,{className:"sm:max-w-lg",children:[e.jsx(L,{children:e.jsx(T,{children:x?"Edit Place":"Add New Place"})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Name *"}),e.jsx(p,{value:r.name,onChange:t=>o(s=>({...s,name:t.target.value})),placeholder:"e.g., Mount Everest Base Camp",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Description"}),e.jsx(G,{value:r.description,onChange:t=>o(s=>({...s,description:t.target.value})),placeholder:"Describe this destination...",rows:3,maxLength:1e3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx(p,{value:r.location,onChange:t=>o(s=>({...s,location:t.target.value})),placeholder:"e.g., Solukhumbu District",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Category"}),e.jsxs(J,{value:r.category,onValueChange:t=>o(s=>({...s,category:t})),children:[e.jsx(K,{children:e.jsx(Q,{placeholder:"Select a category"})}),e.jsx(Z,{children:de.map(t=>e.jsx($,{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Image URL"}),e.jsx(p,{value:r.image_url,onChange:t=>o(s=>({...s,image_url:t.target.value})),placeholder:"https://...",maxLength:500})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>{m(!1),f()},className:"flex-1",children:"Cancel"}),e.jsxs(c,{onClick:F,disabled:N,className:"btn-primary flex-1",children:[N?e.jsx(v,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(se,{className:"w-4 h-4 mr-2"}),x?"Update":"Create"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-card rounded-xl p-6 border border-border",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:l.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Places"})]})]})}),e.jsx("div",{className:"bg-card rounded-xl p-6 border border-border",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-accent/10 flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 text-accent"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:l.length>0?(l.reduce((t,s)=>t+(s.rating||0),0)/l.length).toFixed(1):"0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Rating"})]})]})}),e.jsx("div",{className:"bg-card rounded-xl p-6 border border-border",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-nepal-gold/10 flex items-center justify-center",children:e.jsx(re,{className:"w-6 h-6 text-nepal-gold"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-foreground",children:l.filter(t=>t.image_url).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"With Images"})]})]})})]}),e.jsx("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(v,{className:"w-8 h-8 animate-spin text-primary"})}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No places yet. Add your first destination!"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Place"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Location"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Category"}),e.jsx("th",{className:"text-left p-4 font-medium text-foreground",children:"Rating"}),e.jsx("th",{className:"text-right p-4 font-medium text-foreground",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(t=>e.jsxs("tr",{className:"border-t border-border hover:bg-secondary/50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-secondary flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:t.description})]})]})}),e.jsx("td",{className:"p-4 text-muted-foreground",children:t.location||"-"}),e.jsx("td",{className:"p-4",children:t.category&&e.jsx("span",{className:"bg-accent/10 text-accent px-2 py-1 rounded-full text-xs font-medium",children:t.category})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4 fill-nepal-gold text-nepal-gold"}),e.jsx("span",{className:"text-foreground",children:t.rating||0})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>z(t),children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>M(t.id),className:"text-destructive hover:text-destructive",children:e.jsx(ae,{className:"w-4 h-4"})})]})})]},t.id))})]})})})]})}),e.jsx(Y,{})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"You need admin privileges to view this page."})]})})};export{Se as default};
